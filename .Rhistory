}
g = h
name = "x -> 60 * (x - 1/2)^0.5 - 0.5 * x - exp(x - 1)"
name = "x -> g(x)"
y=g(x)+rnorm(n)
ans=penspl(type,x,y,knots,q,pen)
y_clean = g(ans$xpl)
plot(x,y)
cfit = ans$cfit[order(x, decreasing=FALSE)]
ucfit = ans$ucfit[order(x, decreasing = FALSE)]
x = sort(x,decreasing = FALSE)
error_c = mean(abs(g(ans$xpl)- ans$cpl))
error_uc = mean(abs(g(ans$xpl)- ans$ucpl))
lines(ans$xpl,ans$cpl, col = "blue")
lines(ans$xpl,ans$ucpl,col= "red")
lines(ans$xpl,y_clean,col = "black")
#lines(x,ucfit,col = "green")
#lines(x,cfit,col = "orange")
legend("bottomleft",
legend=c("constrained","unconstrained","objective"),
col = c("blue","red","black"),
lty=1:2,
cex=0.8,
title = paste(name,", n =",as.character(n), ", knots = ", as.character(knots),", error =", as.character(error_c - error_uc))
)
function_8 <- function(x){
f = 0
if (x<0.35){
f = 25 * (x-0.35)^3
}
if (x>0.65){
f = 25* (x-0.65)^3
}
return(f)
}
function_8 = Vectorize(function_8, vectorize.args = "x")
function_8_name = "x -> f(x)"
h = function_9
n = 50
x=runif(n)
p = 3
q = 3
pen = 1
type = 1
knots = round(3 * (n^(1/(2*p + 3))))
g = h
name = "x -> 60 * (x - 1/2)^0.5 - 0.5 * x - exp(x - 1)"
name = "x -> g(x)"
y=g(x)+rnorm(n)
ans=penspl(type,x,y,knots,q,pen)
y_clean = g(ans$xpl)
plot(x,y)
cfit = ans$cfit[order(x, decreasing=FALSE)]
ucfit = ans$ucfit[order(x, decreasing = FALSE)]
x = sort(x,decreasing = FALSE)
error_c = mean(abs(g(ans$xpl)- ans$cpl))
error_uc = mean(abs(g(ans$xpl)- ans$ucpl))
lines(ans$xpl,ans$cpl, col = "blue")
lines(ans$xpl,ans$ucpl,col= "red")
lines(ans$xpl,y_clean,col = "black")
#lines(x,ucfit,col = "green")
#lines(x,cfit,col = "orange")
legend("bottomleft",
legend=c("constrained","unconstrained","objective"),
col = c("blue","red","black"),
lty=1:2,
cex=0.8,
title = paste(name,", n =",as.character(n), ", knots = ", as.character(knots),", error =", as.character(error_c - error_uc))
)
h = Vectorize(function_9, vectorize.args = "x")
n = 50
x=runif(n)
p = 3
q = 3
pen = 1
type = 1
knots = round(3 * (n^(1/(2*p + 3))))
g = h
name = "x -> 60 * (x - 1/2)^0.5 - 0.5 * x - exp(x - 1)"
name = "x -> g(x)"
y=g(x)+rnorm(n)
ans=penspl(type,x,y,knots,q,pen)
y_clean = g(ans$xpl)
plot(x,y)
cfit = ans$cfit[order(x, decreasing=FALSE)]
ucfit = ans$ucfit[order(x, decreasing = FALSE)]
x = sort(x,decreasing = FALSE)
error_c = mean(abs(g(ans$xpl)- ans$cpl))
error_uc = mean(abs(g(ans$xpl)- ans$ucpl))
lines(ans$xpl,ans$cpl, col = "blue")
lines(ans$xpl,ans$ucpl,col= "red")
lines(ans$xpl,y_clean,col = "black")
#lines(x,ucfit,col = "green")
#lines(x,cfit,col = "orange")
legend("bottomleft",
legend=c("constrained","unconstrained","objective"),
col = c("blue","red","black"),
lty=1:2,
cex=0.8,
title = paste(name,", n =",as.character(n), ", knots = ", as.character(knots),", error =", as.character(error_c - error_uc))
)
n = 50
x=runif(n)
p = 3
q = 3
pen = 1
type = 1
knots = round(3 * (n^(1/(2*p + 3))))
g = h
name = "x -> 60 * (x - 1/2)^0.5 - 0.5 * x - exp(x - 1)"
name = "x -> g(x)"
y=g(x)+rnorm(n)
ans=penspl(type,x,y,knots,q,pen)
y_clean = g(ans$xpl)
plot(x,y)
cfit = ans$cfit[order(x, decreasing=FALSE)]
ucfit = ans$ucfit[order(x, decreasing = FALSE)]
x = sort(x,decreasing = FALSE)
error_c = mean(abs(g(ans$xpl)- ans$cpl))
error_uc = mean(abs(g(ans$xpl)- ans$ucpl))
lines(ans$xpl,ans$cpl, col = "blue")
lines(ans$xpl,ans$ucpl,col= "red")
lines(ans$xpl,y_clean,col = "black")
#lines(x,ucfit,col = "green")
#lines(x,cfit,col = "orange")
legend("bottomleft",
legend=c("constrained","unconstrained","objective"),
col = c("blue","red","black"),
lty=1:2,
cex=0.8,
title = paste(name,", n =",as.character(n), ", knots = ", as.character(knots),", error =", as.character(error_c - error_uc))
)
n = 50
x=runif(n)
p = 3
q = 3
pen = 1
type = 1
knots = round(3 * (n^(1/(2*p + 3))))
g = h
name = "x -> 60 * (x - 1/2)^0.5 - 0.5 * x - exp(x - 1)"
name = "x -> g(x)"
y=g(x)+rnorm(n)
ans=penspl(type,x,y,knots,q,pen)
y_clean = g(ans$xpl)
plot(x,y)
cfit = ans$cfit[order(x, decreasing=FALSE)]
ucfit = ans$ucfit[order(x, decreasing = FALSE)]
x = sort(x,decreasing = FALSE)
error_c = mean(abs(g(ans$xpl)- ans$cpl))
error_uc = mean(abs(g(ans$xpl)- ans$ucpl))
lines(ans$xpl,ans$cpl, col = "blue")
lines(ans$xpl,ans$ucpl,col= "red")
lines(ans$xpl,y_clean,col = "black")
#lines(x,ucfit,col = "green")
#lines(x,cfit,col = "orange")
legend("bottomleft",
legend=c("constrained","unconstrained","objective"),
col = c("blue","red","black"),
lty=1:2,
cex=0.8,
title = paste(name,", n =",as.character(n), ", knots = ", as.character(knots),", error =", as.character(error_c - error_uc))
)
n = 50
x=runif(n)
p = 3
q = 3
pen = 1
type = 1
knots = round(3 * (n^(1/(2*p + 3))))
g = h
name = "x -> 60 * (x - 1/2)^0.5 - 0.5 * x - exp(x - 1)"
name = "x -> g(x)"
y=g(x)+rnorm(n)
ans=penspl(type,x,y,knots,q,pen)
y_clean = g(ans$xpl)
plot(x,y)
cfit = ans$cfit[order(x, decreasing=FALSE)]
ucfit = ans$ucfit[order(x, decreasing = FALSE)]
x = sort(x,decreasing = FALSE)
error_c = mean(abs(g(ans$xpl)- ans$cpl))
error_uc = mean(abs(g(ans$xpl)- ans$ucpl))
lines(ans$xpl,ans$cpl, col = "blue")
lines(ans$xpl,ans$ucpl,col= "red")
lines(ans$xpl,y_clean,col = "black")
#lines(x,ucfit,col = "green")
#lines(x,cfit,col = "orange")
legend("bottomleft",
legend=c("constrained","unconstrained","objective"),
col = c("blue","red","black"),
lty=1:2,
cex=0.8,
title = paste(name,", n =",as.character(n), ", knots = ", as.character(knots),", error =", as.character(error_c - error_uc))
)
n = 50
x=runif(n)
p = 3
q = 3
pen = 1
type = 1
knots = round(3 * (n^(1/(2*p + 3))))
g = h
name = "x -> 60 * (x - 1/2)^0.5 - 0.5 * x - exp(x - 1)"
name = "x -> g(x)"
y=g(x)+rnorm(n)
ans=penspl(type,x,y,knots,q,pen)
y_clean = g(ans$xpl)
plot(x,y)
cfit = ans$cfit[order(x, decreasing=FALSE)]
ucfit = ans$ucfit[order(x, decreasing = FALSE)]
x = sort(x,decreasing = FALSE)
error_c = mean(abs(g(ans$xpl)- ans$cpl))
error_uc = mean(abs(g(ans$xpl)- ans$ucpl))
lines(ans$xpl,ans$cpl, col = "blue")
lines(ans$xpl,ans$ucpl,col= "red")
lines(ans$xpl,y_clean,col = "black")
#lines(x,ucfit,col = "green")
#lines(x,cfit,col = "orange")
legend("bottomleft",
legend=c("constrained","unconstrained","objective"),
col = c("blue","red","black"),
lty=1:2,
cex=0.8,
title = paste(name,", n =",as.character(n), ", knots = ", as.character(knots),", error =", as.character(error_c - error_uc))
)
f = Vectorize(function_8,vectorize.args = "x")
n = 50
x=runif(n)
p = 3
q = 3
pen = 1
type = 1
knots = round(3 * (n^(1/(2*p + 3))))
g = f
name = "x -> 60 * (x - 1/2)^0.5 - 0.5 * x - exp(x - 1)"
name = "x -> g(x)"
y=g(x)+rnorm(n)
ans=penspl(type,x,y,knots,q,pen)
y_clean = g(ans$xpl)
plot(x,y)
cfit = ans$cfit[order(x, decreasing=FALSE)]
ucfit = ans$ucfit[order(x, decreasing = FALSE)]
x = sort(x,decreasing = FALSE)
error_c = mean(abs(g(ans$xpl)- ans$cpl))
error_uc = mean(abs(g(ans$xpl)- ans$ucpl))
lines(ans$xpl,ans$cpl, col = "blue")
lines(ans$xpl,ans$ucpl,col= "red")
lines(ans$xpl,y_clean,col = "black")
#lines(x,ucfit,col = "green")
#lines(x,cfit,col = "orange")
legend("bottomleft",
legend=c("constrained","unconstrained","objective"),
col = c("blue","red","black"),
lty=1:2,
cex=0.8,
title = paste(name,", n =",as.character(n), ", knots = ", as.character(knots),", error =", as.character(error_c - error_uc))
)
n = 50
x=runif(n)
p = 3
q = 3
pen = 1
type = 1
knots = round(3 * (n^(1/(2*p + 3))))
g = f
name = "x -> 60 * (x - 1/2)^0.5 - 0.5 * x - exp(x - 1)"
name = "x -> g(x)"
y=g(x)+rnorm(n)
ans=penspl(type,x,y,knots,q,pen)
y_clean = g(ans$xpl)
plot(x,y)
cfit = ans$cfit[order(x, decreasing=FALSE)]
ucfit = ans$ucfit[order(x, decreasing = FALSE)]
x = sort(x,decreasing = FALSE)
error_c = mean(abs(g(ans$xpl)- ans$cpl))
error_uc = mean(abs(g(ans$xpl)- ans$ucpl))
lines(ans$xpl,ans$cpl, col = "blue")
lines(ans$xpl,ans$ucpl,col= "red")
lines(ans$xpl,y_clean,col = "black")
#lines(x,ucfit,col = "green")
#lines(x,cfit,col = "orange")
legend("bottomleft",
legend=c("constrained","unconstrained","objective"),
col = c("blue","red","black"),
lty=1:2,
cex=0.8,
title = paste(name,", n =",as.character(n), ", knots = ", as.character(knots),", error =", as.character(error_c - error_uc))
)
n = 50
x=runif(n)
p = 3
q = 3
pen = 1
type = 1
knots = round(3 * (n^(1/(2*p + 3))))
g = f
name = "x -> 60 * (x - 1/2)^0.5 - 0.5 * x - exp(x - 1)"
name = "x -> g(x)"
y=g(x)+rnorm(n)
ans=penspl(type,x,y,knots,q,pen)
y_clean = g(ans$xpl)
plot(x,y)
cfit = ans$cfit[order(x, decreasing=FALSE)]
ucfit = ans$ucfit[order(x, decreasing = FALSE)]
x = sort(x,decreasing = FALSE)
error_c = mean(abs(g(ans$xpl)- ans$cpl))
error_uc = mean(abs(g(ans$xpl)- ans$ucpl))
lines(ans$xpl,ans$cpl, col = "blue")
lines(ans$xpl,ans$ucpl,col= "red")
lines(ans$xpl,y_clean,col = "black")
#lines(x,ucfit,col = "green")
#lines(x,cfit,col = "orange")
legend("bottomleft",
legend=c("constrained","unconstrained","objective"),
col = c("blue","red","black"),
lty=1:2,
cex=0.8,
title = paste(name,", n =",as.character(n), ", knots = ", as.character(knots),", error =", as.character(error_c - error_uc))
)
n = 50
x=runif(n)
p = 3
q = 3
pen = 1
type = 1
knots = round(3 * (n^(1/(2*p + 3))))
g = f
name = "x -> 60 * (x - 1/2)^0.5 - 0.5 * x - exp(x - 1)"
name = "x -> g(x)"
y=g(x)+rnorm(n)
ans=penspl(type,x,y,knots,q,pen)
y_clean = g(ans$xpl)
plot(x,y)
cfit = ans$cfit[order(x, decreasing=FALSE)]
ucfit = ans$ucfit[order(x, decreasing = FALSE)]
x = sort(x,decreasing = FALSE)
error_c = mean(abs(g(ans$xpl)- ans$cpl))
error_uc = mean(abs(g(ans$xpl)- ans$ucpl))
lines(ans$xpl,ans$cpl, col = "blue")
lines(ans$xpl,ans$ucpl,col= "red")
lines(ans$xpl,y_clean,col = "black")
#lines(x,ucfit,col = "green")
#lines(x,cfit,col = "orange")
legend("bottomleft",
legend=c("constrained","unconstrained","objective"),
col = c("blue","red","black"),
lty=1:2,
cex=0.8,
title = paste(name,", n =",as.character(n), ", knots = ", as.character(knots),", error =", as.character(error_c - error_uc))
)
n = 50
x=runif(n)
p = 3
q = 3
pen = 1
type = 1
knots = round(3 * (n^(1/(2*p + 3))))
g = f
name = "x -> 60 * (x - 1/2)^0.5 - 0.5 * x - exp(x - 1)"
name = "x -> g(x)"
y=g(x)+rnorm(n)
ans=penspl(type,x,y,knots,q,pen)
y_clean = g(ans$xpl)
plot(x,y)
cfit = ans$cfit[order(x, decreasing=FALSE)]
ucfit = ans$ucfit[order(x, decreasing = FALSE)]
x = sort(x,decreasing = FALSE)
error_c = mean(abs(g(ans$xpl)- ans$cpl))
error_uc = mean(abs(g(ans$xpl)- ans$ucpl))
lines(ans$xpl,ans$cpl, col = "blue")
lines(ans$xpl,ans$ucpl,col= "red")
lines(ans$xpl,y_clean,col = "black")
#lines(x,ucfit,col = "green")
#lines(x,cfit,col = "orange")
legend("bottomleft",
legend=c("constrained","unconstrained","objective"),
col = c("blue","red","black"),
lty=1:2,
cex=0.8,
title = paste(name,", n =",as.character(n), ", knots = ", as.character(knots),", error =", as.character(error_c - error_uc))
)
n = 50
x=runif(n)
p = 3
q = 3
pen = 1
type = 1
knots = round(3 * (n^(1/(2*p + 3))))
g = f
name = "x -> 60 * (x - 1/2)^0.5 - 0.5 * x - exp(x - 1)"
name = "x -> g(x)"
y=g(x)+rnorm(n)
ans=penspl(type,x,y,knots,q,pen)
y_clean = g(ans$xpl)
plot(x,y)
cfit = ans$cfit[order(x, decreasing=FALSE)]
ucfit = ans$ucfit[order(x, decreasing = FALSE)]
x = sort(x,decreasing = FALSE)
error_c = mean(abs(g(ans$xpl)- ans$cpl))
error_uc = mean(abs(g(ans$xpl)- ans$ucpl))
lines(ans$xpl,ans$cpl, col = "blue")
lines(ans$xpl,ans$ucpl,col= "red")
lines(ans$xpl,y_clean,col = "black")
#lines(x,ucfit,col = "green")
#lines(x,cfit,col = "orange")
legend("bottomleft",
legend=c("constrained","unconstrained","objective"),
col = c("blue","red","black"),
lty=1:2,
cex=0.8,
title = paste(name,", n =",as.character(n), ", knots = ", as.character(knots),", error =", as.character(error_c - error_uc))
)
n = 50
x=runif(n)
p = 3
q = 3
pen = 1
type = 1
knots = round(3 * (n^(1/(2*p + 3))))
g = f
name = "x -> 60 * (x - 1/2)^0.5 - 0.5 * x - exp(x - 1)"
name = "x -> g(x)"
y=g(x)+rnorm(n)
ans=penspl(type,x,y,knots,q,pen)
y_clean = g(ans$xpl)
plot(x,y)
cfit = ans$cfit[order(x, decreasing=FALSE)]
ucfit = ans$ucfit[order(x, decreasing = FALSE)]
x = sort(x,decreasing = FALSE)
error_c = mean(abs(g(ans$xpl)- ans$cpl))
error_uc = mean(abs(g(ans$xpl)- ans$ucpl))
lines(ans$xpl,ans$cpl, col = "blue")
lines(ans$xpl,ans$ucpl,col= "red")
lines(ans$xpl,y_clean,col = "black")
#lines(x,ucfit,col = "green")
#lines(x,cfit,col = "orange")
legend("bottomleft",
legend=c("constrained","unconstrained","objective"),
col = c("blue","red","black"),
lty=1:2,
cex=0.8,
title = paste(name,", n =",as.character(n), ", knots = ", as.character(knots),", error =", as.character(error_c - error_uc))
)
n = 50
x=runif(n)
p = 3
q = 3
pen = 1
type = 1
knots = round(3 * (n^(1/(2*p + 3))))
g = f
name = "x -> 60 * (x - 1/2)^0.5 - 0.5 * x - exp(x - 1)"
name = "x -> g(x)"
y=g(x)+rnorm(n)
ans=penspl(type,x,y,knots,q,pen)
y_clean = g(ans$xpl)
plot(x,y)
cfit = ans$cfit[order(x, decreasing=FALSE)]
ucfit = ans$ucfit[order(x, decreasing = FALSE)]
x = sort(x,decreasing = FALSE)
error_c = mean(abs(g(ans$xpl)- ans$cpl))
error_uc = mean(abs(g(ans$xpl)- ans$ucpl))
lines(ans$xpl,ans$cpl, col = "blue")
lines(ans$xpl,ans$ucpl,col= "red")
lines(ans$xpl,y_clean,col = "black")
#lines(x,ucfit,col = "green")
#lines(x,cfit,col = "orange")
legend("bottomleft",
legend=c("constrained","unconstrained","objective"),
col = c("blue","red","black"),
lty=1:2,
cex=0.8,
title = paste(name,", n =",as.character(n), ", knots = ", as.character(knots),", error =", as.character(error_c - error_uc))
)
n = 50
x=runif(n)
p = 3
q = 3
pen = 1
type = 1
knots = round(3 * (n^(1/(2*p + 3))))
g = f
name = "x -> 60 * (x - 1/2)^0.5 - 0.5 * x - exp(x - 1)"
name = "x -> g(x)"
y=g(x)+rnorm(n)
ans=penspl(type,x,y,knots,q,pen)
y_clean = g(ans$xpl)
plot(x,y)
cfit = ans$cfit[order(x, decreasing=FALSE)]
ucfit = ans$ucfit[order(x, decreasing = FALSE)]
x = sort(x,decreasing = FALSE)
error_c = mean(abs(g(ans$xpl)- ans$cpl))
error_uc = mean(abs(g(ans$xpl)- ans$ucpl))
lines(ans$xpl,ans$cpl, col = "blue")
lines(ans$xpl,ans$ucpl,col= "red")
lines(ans$xpl,y_clean,col = "black")
#lines(x,ucfit,col = "green")
#lines(x,cfit,col = "orange")
legend("bottomleft",
legend=c("constrained","unconstrained","objective"),
col = c("blue","red","black"),
lty=1:2,
cex=0.8,
title = paste(name,", n =",as.character(n), ", knots = ", as.character(knots),", error =", as.character(error_c - error_uc))
)
for (n in c(50,250,500,2000)){
f = Vectorize(function_8,vectorize.args = "x")
h = Vectorize(function_9, vectorize.args = "x")
g = f
stats = run_simulation(1000,c(n),g,"x -> a * x^5 - b * x - exp(x - 1)")$stats
print(stats)
}
