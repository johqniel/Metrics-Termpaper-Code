lines(ans$xpl,ans$ucpl,col= "red")
lines(ans$xpl,y_clean,col = "black")
#lines(x,ucfit,col = "green")
#lines(x,cfit,col = "orange")
legend("topleft", legend=c("constrained","unconstrained","objective", "ucfit", "cfit"), col = c("blue","red","black", "green", "orange"),lty=1:2,cex=0.8,title = paste(name,", n =",as.character(n)))
x=runif(n)
p = 3
q = 0
pen = 1
knots = round(3 * (n^(1/(2*p + 3))))
g <- function(x){
return(100 * ((x-0.5))^5)
}
name = "Hello"
y=g(x)+rnorm(n)
ans=penspl(5,x,y,10,q,pen)
y_clean = g(ans$xpl)
plot(x,y)
cfit = ans$cfit[order(x, decreasing=FALSE)]
ucfit = ans$ucfit[order(x, decreasing = FALSE)]
x = sort(x,decreasing = FALSE)
lines(ans$xpl,ans$cpl, col = "blue")
lines(ans$xpl,ans$ucpl,col= "red")
lines(ans$xpl,y_clean,col = "black")
#lines(x,ucfit,col = "green")
#lines(x,cfit,col = "orange")
legend("topleft", legend=c("constrained","unconstrained","objective", "ucfit", "cfit"), col = c("blue","red","black", "green", "orange"),lty=1:2,cex=0.8,title = paste(name,", n =",as.character(n)))
x=runif(n)
p = 3
q = 0
pen = 0
knots = round(3 * (n^(1/(2*p + 3))))
g <- function(x){
return(100 * ((x-0.5))^5)
}
name = "Hello"
y=g(x)+rnorm(n)
ans=penspl(5,x,y,10,q,pen)
y_clean = g(ans$xpl)
plot(x,y)
cfit = ans$cfit[order(x, decreasing=FALSE)]
ucfit = ans$ucfit[order(x, decreasing = FALSE)]
x = sort(x,decreasing = FALSE)
lines(ans$xpl,ans$cpl, col = "blue")
lines(ans$xpl,ans$ucpl,col= "red")
lines(ans$xpl,y_clean,col = "black")
#lines(x,ucfit,col = "green")
#lines(x,cfit,col = "orange")
legend("topleft", legend=c("constrained","unconstrained","objective", "ucfit", "cfit"), col = c("blue","red","black", "green", "orange"),lty=1:2,cex=0.8,title = paste(name,", n =",as.character(n)))
name = "Hello"
y=g(x)+rnorm(n)
ans=penspl(5,x,y,10,q,pen)
y_clean = g(ans$xpl)
plot(x,y)
cfit = ans$cfit[order(x, decreasing=FALSE)]
ucfit = ans$ucfit[order(x, decreasing = FALSE)]
x = sort(x,decreasing = FALSE)
lines(ans$xpl,ans$cpl, col = "blue")
lines(ans$xpl,ans$ucpl,col= "red")
lines(ans$xpl,y_clean,col = "black")
#lines(x,ucfit,col = "green")
#lines(x,cfit,col = "orange")
legend("topleft", legend=c("constrained","unconstrained","objective", "ucfit", "cfit"), col = c("blue","red","black", "green", "orange"),lty=1:2,cex=0.8,title = paste(name,", n =",as.character(n), ", knots = ", as.character(knots)))
x=runif(n)
p = 3
q = 0
pen = 0
n = 1000
knots = round(3 * (n^(1/(2*p + 3))))
g <- function(x){
return(100 * ((x-0.5))^5)
}
name = "Hello"
y=g(x)+rnorm(n)
ans=penspl(5,x,y,10,q,pen)
y_clean = g(ans$xpl)
plot(x,y)
cfit = ans$cfit[order(x, decreasing=FALSE)]
ucfit = ans$ucfit[order(x, decreasing = FALSE)]
x = sort(x,decreasing = FALSE)
lines(ans$xpl,ans$cpl, col = "blue")
lines(ans$xpl,ans$ucpl,col= "red")
lines(ans$xpl,y_clean,col = "black")
#lines(x,ucfit,col = "green")
#lines(x,cfit,col = "orange")
legend("topleft", legend=c("constrained","unconstrained","objective", "ucfit", "cfit"), col = c("blue","red","black", "green", "orange"),lty=1:2,cex=0.8,title = paste(name,", n =",as.character(n), ", knots = ", as.character(knots)))
n = 1000
x=runif(n)
p = 3
q = 0
pen = 0
knots = round(3 * (n^(1/(2*p + 3))))
g <- function(x){
return(100 * ((x-0.5))^5)
}
name = "Hello"
y=g(x)+rnorm(n)
ans=penspl(5,x,y,10,q,pen)
y_clean = g(ans$xpl)
plot(x,y)
cfit = ans$cfit[order(x, decreasing=FALSE)]
ucfit = ans$ucfit[order(x, decreasing = FALSE)]
x = sort(x,decreasing = FALSE)
lines(ans$xpl,ans$cpl, col = "blue")
lines(ans$xpl,ans$ucpl,col= "red")
lines(ans$xpl,y_clean,col = "black")
#lines(x,ucfit,col = "green")
#lines(x,cfit,col = "orange")
legend("topleft", legend=c("constrained","unconstrained","objective", "ucfit", "cfit"), col = c("blue","red","black", "green", "orange"),lty=1:2,cex=0.8,title = paste(name,", n =",as.character(n), ", knots = ", as.character(knots)))
n = 1000
x=runif(n)
p = 3
q = 0
pen = 0
knots = round(3 * (n^(1/(2*p + 3))))
g <- function(x){
return(100 * ((x-0.5))^5)
}
name = "Hello"
y=g(x)+rnorm(n)
ans=penspl(5,x,y,10,q,pen)
y_clean = g(ans$xpl)
plot(x,y)
cfit = ans$cfit[order(x, decreasing=FALSE)]
ucfit = ans$ucfit[order(x, decreasing = FALSE)]
x = sort(x,decreasing = FALSE)
lines(ans$xpl,ans$cpl, col = "blue")
lines(ans$xpl,ans$ucpl,col= "red")
lines(ans$xpl,y_clean,col = "black")
#lines(x,ucfit,col = "green")
#lines(x,cfit,col = "orange")
legend("topleft", legend=c("constrained","unconstrained","objective", "ucfit", "cfit"), col = c("blue","red","black", "green", "orange"),lty=1:2,cex=0.8,title = paste(name,", n =",as.character(n), ", knots = ", as.character(knots)))
n = 10000
x=runif(n)
p = 3
q = 0
pen = 0
knots = round(3 * (n^(1/(2*p + 3))))
g <- function(x){
return(100 * ((x-0.5))^5)
}
name = "Hello"
y=g(x)+rnorm(n)
ans=penspl(5,x,y,10,q,pen)
y_clean = g(ans$xpl)
plot(x,y)
cfit = ans$cfit[order(x, decreasing=FALSE)]
ucfit = ans$ucfit[order(x, decreasing = FALSE)]
x = sort(x,decreasing = FALSE)
lines(ans$xpl,ans$cpl, col = "blue")
lines(ans$xpl,ans$ucpl,col= "red")
lines(ans$xpl,y_clean,col = "black")
#lines(x,ucfit,col = "green")
#lines(x,cfit,col = "orange")
legend("topleft", legend=c("constrained","unconstrained","objective", "ucfit", "cfit"), col = c("blue","red","black", "green", "orange"),lty=1:2,cex=0.8,title = paste(name,", n =",as.character(n), ", knots = ", as.character(knots)))
n = 4000
x=runif(n)
p = 3
q = 3
pen = 2.5
knots = round(3 * (n^(1/(2*p + 3))))
g <- function(x){
return(100 * ((x-0.5))^5)
}
name = "Hello"
y=g(x)+rnorm(n)
ans=penspl(5,x,y,10,q,pen)
y_clean = g(ans$xpl)
plot(x,y)
cfit = ans$cfit[order(x, decreasing=FALSE)]
ucfit = ans$ucfit[order(x, decreasing = FALSE)]
x = sort(x,decreasing = FALSE)
lines(ans$xpl,ans$cpl, col = "blue")
lines(ans$xpl,ans$ucpl,col= "red")
lines(ans$xpl,y_clean,col = "black")
#lines(x,ucfit,col = "green")
#lines(x,cfit,col = "orange")
legend("topleft", legend=c("constrained","unconstrained","objective", "ucfit", "cfit"), col = c("blue","red","black", "green", "orange"),lty=1:2,cex=0.8,title = paste(name,", n =",as.character(n), ", knots = ", as.character(knots)))
n = 4000
x=runif(n)
p = 3
q = 3
pen = 0.1
knots = round(3 * (n^(1/(2*p + 3))))
g <- function(x){
return(100 * ((x-0.5))^5)
}
name = "Hello"
y=g(x)+rnorm(n)
ans=penspl(5,x,y,10,q,pen)
y_clean = g(ans$xpl)
plot(x,y)
cfit = ans$cfit[order(x, decreasing=FALSE)]
ucfit = ans$ucfit[order(x, decreasing = FALSE)]
x = sort(x,decreasing = FALSE)
lines(ans$xpl,ans$cpl, col = "blue")
lines(ans$xpl,ans$ucpl,col= "red")
lines(ans$xpl,y_clean,col = "black")
#lines(x,ucfit,col = "green")
#lines(x,cfit,col = "orange")
legend("topleft", legend=c("constrained","unconstrained","objective", "ucfit", "cfit"), col = c("blue","red","black", "green", "orange"),lty=1:2,cex=0.8,title = paste(name,", n =",as.character(n), ", knots = ", as.character(knots)))
n = 4000
x=runif(n)
p = 3
q = 3
pen = -5
knots = round(3 * (n^(1/(2*p + 3))))
g <- function(x){
return(100 * ((x-0.5))^5)
}
name = "Hello"
y=g(x)+rnorm(n)
ans=penspl(5,x,y,10,q,pen)
y_clean = g(ans$xpl)
plot(x,y)
cfit = ans$cfit[order(x, decreasing=FALSE)]
ucfit = ans$ucfit[order(x, decreasing = FALSE)]
x = sort(x,decreasing = FALSE)
lines(ans$xpl,ans$cpl, col = "blue")
lines(ans$xpl,ans$ucpl,col= "red")
lines(ans$xpl,y_clean,col = "black")
#lines(x,ucfit,col = "green")
#lines(x,cfit,col = "orange")
legend("topleft", legend=c("constrained","unconstrained","objective", "ucfit", "cfit"), col = c("blue","red","black", "green", "orange"),lty=1:2,cex=0.8,title = paste(name,", n =",as.character(n), ", knots = ", as.character(knots)))
n = 4000
x=runif(n)
p = 3
q = 0
pen = 0
knots = round(3 * (n^(1/(2*p + 3))))
g <- function(x){
return(100 * ((x-0.5))^5)
}
name = "Hello"
y=g(x)+rnorm(n)
ans=penspl(5,x,y,10,q,pen)
y_clean = g(ans$xpl)
plot(x,y)
cfit = ans$cfit[order(x, decreasing=FALSE)]
ucfit = ans$ucfit[order(x, decreasing = FALSE)]
x = sort(x,decreasing = FALSE)
lines(ans$xpl,ans$cpl, col = "blue")
lines(ans$xpl,ans$ucpl,col= "red")
lines(ans$xpl,y_clean,col = "black")
#lines(x,ucfit,col = "green")
#lines(x,cfit,col = "orange")
legend("topleft", legend=c("constrained","unconstrained","objective", "ucfit", "cfit"), col = c("blue","red","black", "green", "orange"),lty=1:2,cex=0.8,title = paste(name,", n =",as.character(n), ", knots = ", as.character(knots)))
n = 4000
x=runif(n)
p = 3
q = 0
pen = 10000
knots = round(3 * (n^(1/(2*p + 3))))
g <- function(x){
return(100 * ((x-0.5))^5)
}
name = "Hello"
y=g(x)+rnorm(n)
ans=penspl(5,x,y,10,q,pen)
y_clean = g(ans$xpl)
plot(x,y)
cfit = ans$cfit[order(x, decreasing=FALSE)]
ucfit = ans$ucfit[order(x, decreasing = FALSE)]
x = sort(x,decreasing = FALSE)
lines(ans$xpl,ans$cpl, col = "blue")
lines(ans$xpl,ans$ucpl,col= "red")
lines(ans$xpl,y_clean,col = "black")
#lines(x,ucfit,col = "green")
#lines(x,cfit,col = "orange")
legend("topleft", legend=c("constrained","unconstrained","objective", "ucfit", "cfit"), col = c("blue","red","black", "green", "orange"),lty=1:2,cex=0.8,title = paste(name,", n =",as.character(n), ", knots = ", as.character(knots)))
n = 4000
x=runif(n)
p = 3
q = 0
pen = 10
knots = round(3 * (n^(1/(2*p + 3))))
g <- function(x){
return(100 * ((x-0.5))^5)
}
name = "Hello"
y=g(x)+rnorm(n)
ans=penspl(5,x,y,10,q,pen)
y_clean = g(ans$xpl)
plot(x,y)
cfit = ans$cfit[order(x, decreasing=FALSE)]
ucfit = ans$ucfit[order(x, decreasing = FALSE)]
x = sort(x,decreasing = FALSE)
lines(ans$xpl,ans$cpl, col = "blue")
lines(ans$xpl,ans$ucpl,col= "red")
lines(ans$xpl,y_clean,col = "black")
#lines(x,ucfit,col = "green")
#lines(x,cfit,col = "orange")
legend("topleft", legend=c("constrained","unconstrained","objective", "ucfit", "cfit"), col = c("blue","red","black", "green", "orange"),lty=1:2,cex=0.8,title = paste(name,", n =",as.character(n), ", knots = ", as.character(knots)))
n = 4000
x=runif(n)
p = 3
q = 0
pen = 10
knots = round(3 * (n^(1/(2*p + 3))))
g <- function(x){
return(100 * ((x-0.5))^5)
}
name = "Hello"
y=g(x)+rnorm(n)
ans=penspl(1,x,y,10,q,pen)
y_clean = g(ans$xpl)
plot(x,y)
cfit = ans$cfit[order(x, decreasing=FALSE)]
ucfit = ans$ucfit[order(x, decreasing = FALSE)]
x = sort(x,decreasing = FALSE)
lines(ans$xpl,ans$cpl, col = "blue")
lines(ans$xpl,ans$ucpl,col= "red")
lines(ans$xpl,y_clean,col = "black")
#lines(x,ucfit,col = "green")
#lines(x,cfit,col = "orange")
legend("topleft", legend=c("constrained","unconstrained","objective", "ucfit", "cfit"), col = c("blue","red","black", "green", "orange"),lty=1:2,cex=0.8,title = paste(name,", n =",as.character(n), ", knots = ", as.character(knots)))
n = 100
x=runif(n)
p = 3
q = 0
pen = 10
knots = round(3 * (n^(1/(2*p + 3))))
g <- function(x){
return(100 * ((x-0.5))^5)
}
name = "Hello"
y=g(x)+rnorm(n)
ans=penspl(1,x,y,10,q,pen)
y_clean = g(ans$xpl)
plot(x,y)
cfit = ans$cfit[order(x, decreasing=FALSE)]
ucfit = ans$ucfit[order(x, decreasing = FALSE)]
x = sort(x,decreasing = FALSE)
lines(ans$xpl,ans$cpl, col = "blue")
lines(ans$xpl,ans$ucpl,col= "red")
lines(ans$xpl,y_clean,col = "black")
#lines(x,ucfit,col = "green")
#lines(x,cfit,col = "orange")
legend("topleft", legend=c("constrained","unconstrained","objective", "ucfit", "cfit"), col = c("blue","red","black", "green", "orange"),lty=1:2,cex=0.8,title = paste(name,", n =",as.character(n), ", knots = ", as.character(knots)))
n = 100
x=runif(n)
p = 3
q = 3
pen = 2.5
knots = round(3 * (n^(1/(2*p + 3))))
g <- function(x){
return(100 * ((x-0.5))^5)
}
name = "Hello"
y=g(x)+rnorm(n)
ans=penspl(1,x,y,10,q,pen)
y_clean = g(ans$xpl)
plot(x,y)
cfit = ans$cfit[order(x, decreasing=FALSE)]
ucfit = ans$ucfit[order(x, decreasing = FALSE)]
x = sort(x,decreasing = FALSE)
lines(ans$xpl,ans$cpl, col = "blue")
lines(ans$xpl,ans$ucpl,col= "red")
lines(ans$xpl,y_clean,col = "black")
#lines(x,ucfit,col = "green")
#lines(x,cfit,col = "orange")
legend("topleft", legend=c("constrained","unconstrained","objective", "ucfit", "cfit"), col = c("blue","red","black", "green", "orange"),lty=1:2,cex=0.8,title = paste(name,", n =",as.character(n), ", knots = ", as.character(knots)))
n = 100
x=runif(n)
p = 3
q = 3
pen = 2.5
knots = round(3 * (n^(1/(2*p + 3))))
g <- function(x){
return(100 * ((x-0.5))^5)
}
name = "Hello"
y=g(x)+rnorm(n)
ans=penspl(1,x,y,10,q,pen)
y_clean = g(ans$xpl)
plot(x,y)
cfit = ans$cfit[order(x, decreasing=FALSE)]
ucfit = ans$ucfit[order(x, decreasing = FALSE)]
x = sort(x,decreasing = FALSE)
lines(ans$xpl,ans$cpl, col = "blue")
lines(ans$xpl,ans$ucpl,col= "red")
lines(ans$xpl,y_clean,col = "black")
#lines(x,ucfit,col = "green")
#lines(x,cfit,col = "orange")
legend("topleft", legend=c("constrained","unconstrained","objective", "ucfit", "cfit"), col = c("blue","red","black", "green", "orange"),lty=1:2,cex=0.8,title = paste(name,", n =",as.character(n), ", knots = ", as.character(knots)))
n = 100
p = 3
knots = round(3 * (n^(1/(2*p + 3))))
q = 3
pen = 2.5
type = 1
for (bundle in objective_functions){
print("enter for")
objective_function = bundle[[1]]
print("read f")
name = bundle[[2]]
x = runif(n)
y = objective_function(x) + rnorm(50)
ans = penspl(type,x,y,knots,q,pen)
y_clean = objective_function(ans$xpl)
plot(x,y)
lines(ans$xpl,ans$cpl, col = "blue")
lines(ans$xpl,ans$ucpl,col= "red")
lines(ans$xpl,y_clean,col = "black")
legend("topleft", legend=c("constrained","unconstrained","objective"), col = c("blue","red","black"),lty=1:2,cex=0.8,title = paste(name,", n =",as.character(n)))
}
n = 100
p = 3
knots = round(3 * (n^(1/(2*p + 3))))
q = 3
pen = 2.5
type = 1
for (bundle in objective_functions){
print("enter for")
objective_function = bundle[[1]]
print("read f")
name = bundle[[2]]
x = runif(n)
y = objective_function(x) + rnorm(50)
ans = penspl(type,x,y,knots,q,pen)
y_clean = objective_function(ans$xpl)
plot(x,y)
lines(ans$xpl,ans$cpl, col = "blue")
lines(ans$xpl,ans$ucpl,col= "red")
lines(ans$xpl,y_clean,col = "black")
legend("topleft", legend=c("constrained","unconstrained","objective"), col = c("blue","red","black"),lty=1:2,cex=0.8,title = paste(name,", n =",as.character(n), ", knots = ",as.character(knots), ", penalty = ", as.character(pen)))
n = 100
p = 3
knots = round(3 * (n^(1/(2*p + 3))))
q = 3
pen = 2.5
type = 1
for (bundle in objective_functions){
print("enter for")
objective_function = bundle[[1]]
print("read f")
name = bundle[[2]]
x = runif(n)
y = objective_function(x) + rnorm(50)
ans = penspl(type,x,y,knots,q,pen)
y_clean = objective_function(ans$xpl)
plot(x,y)
lines(ans$xpl,ans$cpl, col = "blue")
lines(ans$xpl,ans$ucpl,col= "red")
lines(ans$xpl,y_clean,col = "black")
legend("topleft", legend=c("constrained","unconstrained","objective"), col = c("blue","red","black"),lty=1:2,cex=0.8,title = paste(name,", n =",as.character(n), ", knots = ",as.character(knots), ", penalty = ", as.character(pen)))
n = 100
x=runif(n)
p = 3
q = 3
pen = 2.5
knots = round(3 * (n^(1/(2*p + 3))))
g <- function(x){
return(100 * ((x-0.5))^5)
}
name = "Hello"
y=g(x)+rnorm(n)
ans=penspl(1,x,y,10,q,pen)
y_clean = g(ans$xpl)
plot(x,y)
cfit = ans$cfit[order(x, decreasing=FALSE)]
ucfit = ans$ucfit[order(x, decreasing = FALSE)]
x = sort(x,decreasing = FALSE)
lines(ans$xpl,ans$cpl, col = "blue")
lines(ans$xpl,ans$ucpl,col= "red")
lines(ans$xpl,y_clean,col = "black")
#lines(x,ucfit,col = "green")
#lines(x,cfit,col = "orange")
legend("topleft", legend=c("constrained","unconstrained","objective", "ucfit", "cfit"), col = c("blue","red","black", "green", "orange"),lty=1:2,cex=0.8,title = paste(name,", n =",as.character(n), ", knots = ", as.character(knots)))
n = 100
p = 3
knots = round(3 * (n^(1/(2*p + 3))))
q = 3
pen = 2.5
type = 1
for (bundle in objective_functions){
print("enter for")
objective_function = bundle[[1]]
print("read f")
name = bundle[[2]]
x = runif(n)
y = objective_function(x) + rnorm(50)
ans = penspl(type,x,y,knots,q,pen)
y_clean = objective_function(ans$xpl)
plot(x,y)
lines(ans$xpl,ans$cpl, col = "blue")
lines(ans$xpl,ans$ucpl,col= "red")
lines(ans$xpl,y_clean,col = "black")
legend("topleft", legend=c("constrained","unconstrained","objective"), col = c("blue","red","black"),lty=1:2,cex=0.8,title = paste(name,", n =",as.character(n), ", knots = ",as.character(knots), ", penalty = ", as.character(pen)))
n = 100
x=runif(n)
p = 3
q = 3
pen = 2.5
knots = round(3 * (n^(1/(2*p + 3))))
g <- function(x){
return(100 * ((x-0.5))^5)
}
name = "Hello"
y=g(x)+rnorm(n)
ans=penspl(1,x,y,10,q,pen)
y_clean = g(ans$xpl)
plot(x,y)
cfit = ans$cfit[order(x, decreasing=FALSE)]
ucfit = ans$ucfit[order(x, decreasing = FALSE)]
x = sort(x,decreasing = FALSE)
lines(ans$xpl,ans$cpl, col = "blue")
lines(ans$xpl,ans$ucpl,col= "red")
lines(ans$xpl,y_clean,col = "black")
#lines(x,ucfit,col = "green")
#lines(x,cfit,col = "orange")
legend("topleft", legend=c("constrained","unconstrained","objective", "ucfit", "cfit"), col = c("blue","red","black", "green", "orange"),lty=1:2,cex=0.8,title = paste(name,", n =",as.character(n), ", knots = ", as.character(knots)))
